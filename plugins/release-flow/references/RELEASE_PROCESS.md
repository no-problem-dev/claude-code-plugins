# ãƒªãƒªãƒ¼ã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚¬ã‚¤ãƒ‰

Stockleã®æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ãƒªãƒªãƒ¼ã‚¹æ‰‹é †

### 1. ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã§é–‹ç™º

```bash
# ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã«åˆ‡ã‚Šæ›¿ãˆï¼ˆä¾‹: release/v0.0.2ï¼‰
git checkout release/v0.0.2
git pull origin release/v0.0.2
```

### 2. CHANGELOG.mdã‚’æ›´æ–°

é–‹ç™ºä¸­ã¯ã€Œæœªãƒªãƒªãƒ¼ã‚¹ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å¤‰æ›´ã‚’è¨˜éŒ²ï¼š

```markdown
## [æœªãƒªãƒªãƒ¼ã‚¹]

### è¿½åŠ 
- æ–°æ©Ÿèƒ½ã®èª¬æ˜

### ä¿®æ­£
- ãƒã‚°ä¿®æ­£ã®èª¬æ˜
```

### 3. ãƒªãƒªãƒ¼ã‚¹æº–å‚™

ãƒªãƒªãƒ¼ã‚¹æº–å‚™ãŒã§ããŸã‚‰ã€ã€Œæœªãƒªãƒªãƒ¼ã‚¹ã€ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã«å¤‰æ›ï¼š

```markdown
## [0.0.2] - 2025-01-23

### è¿½åŠ 
- æ–°æ©Ÿèƒ½ã®èª¬æ˜

### ä¿®æ­£
- ãƒã‚°ä¿®æ­£ã®èª¬æ˜
```

**é‡è¦**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã¯å¿…ãšãƒ–ãƒ©ãƒ³ãƒåã¨ä¸€è‡´ã•ã›ã‚‹ï¼ˆ`release/v0.0.2` â†’ `[0.0.2]`ï¼‰

### 4. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥

```bash
git add CHANGELOG.md
git commit -m "chore: prepare for v0.0.2 release"
git push origin release/v0.0.2
```

### 5. PRã‚’mainã«ãƒãƒ¼ã‚¸

```bash
# PRã‚’ãƒãƒ¼ã‚¸ï¼ˆã“ã‚ŒãŒè‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ã®ãƒˆãƒªã‚¬ãƒ¼ï¼‰
gh pr merge <PRç•ªå·> --squash
```

**ã“ã®ãƒãƒ¼ã‚¸ã§è‡ªå‹•çš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨:**
1. ã‚¿ã‚° `v0.0.2` ãŒä½œæˆã•ã‚Œã‚‹
2. GitHub Release `v0.0.2` ãŒä½œæˆã•ã‚Œã‚‹
3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Cloud Runã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹
4. iOS: Xcode Cloudã§ãƒ“ãƒ«ãƒ‰ãƒ»é…å¸ƒãŒå®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
5. æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒ `release/v0.0.3` ãŒä½œæˆã•ã‚Œã‚‹
6. æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹ç”¨ã®ãƒ‰ãƒ©ãƒ•ãƒˆPRãŒä½œæˆã•ã‚Œã‚‹

### 6. ãƒªãƒªãƒ¼ã‚¹å®Œäº†ã‚’ç¢ºèª

```bash
# GitHub Releaseã‚’ç¢ºèª
gh release view v0.0.2

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ç¢ºèª
gcloud run services describe stockle-backend --region asia-northeast1

# æ¬¡ã®ãƒ‰ãƒ©ãƒ•ãƒˆPRã‚’ç¢ºèª
gh pr list --state all --limit 1
```

## ğŸ”¢ ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°è¦å‰‡

[ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°](https://semver.org/lang/ja/)ã«æº–æ‹ : `MAJOR.MINOR.PATCH`

| å¤‰æ›´å†…å®¹ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ä¾‹ |
|---------|-----------|-----|
| ãƒã‚°ä¿®æ­£ã®ã¿ | PATCH | 0.0.2 â†’ 0.0.3 |
| æ–°æ©Ÿèƒ½è¿½åŠ ï¼ˆå¾Œæ–¹äº’æ›ï¼‰ | MINOR | 0.0.3 â†’ 0.1.0 |
| ç ´å£Šçš„å¤‰æ›´ | MAJOR | 0.1.0 â†’ 1.0.0 |

**æ³¨æ„**: ç¾åœ¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯è‡ªå‹•çš„ã«PATCHã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã—ã¾ã™ã€‚MINOR/MAJORãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã®å ´åˆã¯ã€æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒåã‚’æ‰‹å‹•ã§èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ CHANGELOGã®æ›¸ãæ–¹

[Keep a Changelog](https://keepachangelog.com/ja/1.0.0/)å½¢å¼ã«æº–æ‹ ã—ã¾ã™ã€‚

### å¤‰æ›´ã®åˆ†é¡

- **è¿½åŠ  (Added)**: æ–°æ©Ÿèƒ½
- **å¤‰æ›´ (Changed)**: æ—¢å­˜æ©Ÿèƒ½ã®å¤‰æ›´
- **éæ¨å¥¨ (Deprecated)**: é–“ã‚‚ãªãå‰Šé™¤ã•ã‚Œã‚‹æ©Ÿèƒ½
- **å‰Šé™¤ (Removed)**: å‰Šé™¤ã•ã‚ŒãŸæ©Ÿèƒ½
- **ä¿®æ­£ (Fixed)**: ãƒã‚°ä¿®æ­£
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ (Security)**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£ã®å¤‰æ›´

### è‰¯ã„ä¾‹

```markdown
## [0.0.2] - 2025-01-23

### è¿½åŠ 
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: POST /api/v1/activity-logs ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã—ã€ç­‹ãƒˆãƒ¬ãƒ­ã‚°ã®è¨˜éŒ²ã«å¯¾å¿œ
- **iOS**: ç­‹è‚‰è³‡ç”£ã®å¯è¦–åŒ–æ©Ÿèƒ½ã‚’å®Ÿè£…ï¼ˆ3å±¤ã‚°ãƒ©ãƒ•è¡¨ç¤ºï¼‰

### ä¿®æ­£
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Firebase Emulatorç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹é©åˆ‡ãªåˆ‡ã‚Šæ›¿ãˆã‚’å®Ÿè£…
- **iOS**: æ¼¸åŒ–å¼è¨ˆç®—ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„
```

**è‰¯ã„ç‚¹:**
- å…·ä½“çš„ã§è©³ç´°ãªèª¬æ˜
- ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰/iOSï¼‰ã‚’æ˜è¨˜
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ã®ä¾¡å€¤ãŒæ˜ç¢º
- å¤ªå­—ã§é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã‚’å¼·èª¿

### æ‚ªã„ä¾‹

```markdown
## [0.0.2] - 2025-01-23

### å¤‰æ›´
- ã„ã‚ã„ã‚ä¿®æ­£ã—ãŸ
- ãƒã‚°ç›´ã—ãŸ
```

**æ‚ªã„ç‚¹:**
- ä½•ãŒå¤‰ã‚ã£ãŸã®ã‹ä¸æ˜ç¢º
- ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãŒä¸æ˜
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ã®ä¾¡å€¤ãŒä¸æ˜

## âš™ï¸ è‡ªå‹•åŒ–ã®ä»•çµ„ã¿

### auto-release-on-merge.yml

**ãƒˆãƒªã‚¬ãƒ¼**: ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒï¼ˆ`release/vX.Y.Z`ï¼‰ãŒmainã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸã¨ã

**å‡¦ç†å†…å®¹:**
1. ãƒ–ãƒ©ãƒ³ãƒåã‹ã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŠ½å‡º
2. CHANGELOG.mdã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã™ã‚‹ã‹æ¤œè¨¼
3. ã‚¿ã‚°ã‚’è‡ªå‹•ä½œæˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥
4. CHANGELOG.mdã‹ã‚‰è©²å½“ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡º
5. ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
6. GitHub Releaseã‚’ä½œæˆ
7. æ¬¡ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨ˆç®—ï¼ˆPATCHã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆï¼‰
8. æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ
9. CHANGELOG.mdã«ã€Œæœªãƒªãƒªãƒ¼ã‚¹ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
10. æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹ç”¨ã®ãƒ‰ãƒ©ãƒ•ãƒˆPRã‚’ä½œæˆ

### deploy-to-cloud-run.yml

**ãƒˆãƒªã‚¬ãƒ¼**: mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ã‚¸å¾Œï¼‰

**å‡¦ç†å†…å®¹:**
1. Cloud Buildã§ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
2. Artifact Registryã«ãƒ—ãƒƒã‚·ãƒ¥
3. Cloud Runã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
4. ãƒ‡ãƒ—ãƒ­ã‚¤çµæœã‚’é€šçŸ¥

### Xcode Cloudï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰

**ãƒˆãƒªã‚¬ãƒ¼**: mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã¾ãŸã¯ã‚¿ã‚°ä½œæˆ

**å‡¦ç†å†…å®¹:**
1. iOSã‚¢ãƒ—ãƒªã®ãƒ“ãƒ«ãƒ‰
2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
3. TestFlightã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆè¨­å®šã«ã‚ˆã‚‹ï¼‰
4. App Store Connectã¸ã®é…å¸ƒï¼ˆè¨­å®šã«ã‚ˆã‚‹ï¼‰

### ãƒ•ãƒ­ãƒ¼å›³

```
PRãƒãƒ¼ã‚¸ (release/vX.Y.Z â†’ main)
  â†“
auto-release-on-merge.yml å®Ÿè¡Œ
  â†“
ã‚¿ã‚°ä½œæˆ â†’ GitHub Releaseä½œæˆ â†’ æ¬¡ã®ãƒªãƒªãƒ¼ã‚¹æº–å‚™
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â”‚                     â”‚
deploy-to-cloud-run  Xcode Cloud
(ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰)         (iOS)
  â†“                     â†“
Docker Build â†’      iOS Build â†’
Cloud Run Deploy    TestFlight
```

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### CHANGELOGæ¤œè¨¼ã‚¨ãƒ©ãƒ¼

**ã‚¨ãƒ©ãƒ¼**: `âŒ ã‚¨ãƒ©ãƒ¼: CHANGELOG.mdã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ [X.Y.Z] ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`

**å¯¾å‡¦æ³•**:
1. ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã§CHANGELOG.mdã‚’ä¿®æ­£
2. ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ç¢ºèª: `## [X.Y.Z] - YYYY-MM-DD`
3. å†åº¦ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥ã—ã¦PRã‚’ãƒãƒ¼ã‚¸

### GitHub Releaseä½œæˆå¤±æ•—

**åŸå› **: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æ¨©é™ä¸è¶³

**å¯¾å‡¦æ³•**:
1. ãƒªãƒã‚¸ãƒˆãƒªè¨­å®š > Actions > General
2. "Workflow permissions" ã‚’ "Read and write permissions" ã«è¨­å®š

### Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤å¤±æ•—

**åŸå› **: ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¨©é™ä¸è¶³ã¾ãŸã¯Secret Managerè¨­å®šä¸è¶³

**å¯¾å‡¦æ³•**:
```bash
# Secret Manageræ¨©é™ã‚’ç¢ºèª
gcloud projects get-iam-policy stockle-dev \
  --flatten="bindings[].members" \
  --filter="bindings.members:serviceAccount:YOUR-SERVICE-ACCOUNT"

# å¿…è¦ã«å¿œã˜ã¦æ¨©é™ã‚’è¿½åŠ 
gcloud projects add-iam-policy-binding stockle-dev \
  --member="serviceAccount:YOUR-SERVICE-ACCOUNT" \
  --role="roles/secretmanager.secretAccessor"
```

### Xcode Cloudãƒ“ãƒ«ãƒ‰å¤±æ•—

**åŸå› **: ä¾å­˜é–¢ä¿‚ã®å•é¡Œã€ç½²åã®å•é¡Œã€ã¾ãŸã¯ãƒ“ãƒ«ãƒ‰è¨­å®šã®ä¸å‚™

**å¯¾å‡¦æ³•**:
1. Xcode Cloud > ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’ç¢ºèª
2. ä¾å­˜é–¢ä¿‚ã®æ›´æ–°: Swift Package Managerã®ä¾å­˜é–¢ä¿‚ã‚’ç¢ºèª
3. ç½²åè¨­å®š: Certificates, Identifiers & Profilesã‚’ç¢ºèª
4. ci_scriptsã®ç¢ºèª: ci_post_clone.shãªã©ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ¤œè¨¼

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’é–“é•ãˆãŸå ´åˆ

**ãƒãƒ¼ã‚¸å‰**: PRã‚’é–‰ã˜ã¦ã€CHANGELOG.mdã‚’ä¿®æ­£ã—ã¦ã‹ã‚‰å†åº¦PRã‚’ä½œæˆ

**ãƒãƒ¼ã‚¸å¾Œ**:
```bash
# ã‚¿ã‚°ã‚’å‰Šé™¤
git push origin :refs/tags/vX.Y.Z

# GitHub Releaseã‚’æ‰‹å‹•ã§å‰Šé™¤ï¼ˆWebãƒšãƒ¼ã‚¸ã‹ã‚‰ï¼‰

# mainãƒ–ãƒ©ãƒ³ãƒã§CHANGELOG.mdã‚’ä¿®æ­£ã—ã¦ã‚³ãƒŸãƒƒãƒˆ
# æ­£ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å†åº¦ãƒªãƒªãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã¦PRã‚’ãƒãƒ¼ã‚¸
```

## ğŸ“š å‚è€ƒè³‡æ–™

- [ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°](https://semver.org/lang/ja/)
- [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/)
- [GitHub Releases](https://docs.github.com/ja/repositories/releasing-projects-on-github/about-releases)
- [Cloud Run Deployment](https://cloud.google.com/run/docs/deploying)
- [Xcode Cloud](https://developer.apple.com/xcode-cloud/)

## ğŸ“ é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- [.github/workflows/auto-release-on-merge.yml](.github/workflows/auto-release-on-merge.yml) - ãƒªãƒªãƒ¼ã‚¹è‡ªå‹•åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- [.github/workflows/deploy-to-cloud-run.yml](.github/workflows/deploy-to-cloud-run.yml) - Cloud Runãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- [cloudbuild.yaml](cloudbuild.yaml) - Cloud Buildè¨­å®š
- [CHANGELOG.md](CHANGELOG.md) - å¤‰æ›´å±¥æ­´
